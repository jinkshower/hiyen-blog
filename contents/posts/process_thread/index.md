---
title: "프로세스"
description: "프로세스 공부 기록"
date: 2023-12-28
update: 2023-12-28
tags:
  - process
  - operating_system
series: "process"
---

'혼자 공부하는 시스템구조&운영체제'를 읽고 공부한 내용
## 프로세스 

### Process? Program?   
우리는 흔히 `프로그램을 실행한다` 라고 말한다.
이는 '보조기억장치에 있는 데이터 뭉치'인 `프로그램`을  '메모리에 적재하고 cpu가 실행'하여 `프로세스`화 한다와 같은 말이다. 

### PCB Process Control Block    
모든 프로세스는 CPU를 사용해야 하지만 CPU의 자원은 한정적이다.
그래서 프로세스의 실행 순서와 자원관리를 위해 프로세스마다 `PCB`라는 부가 정보를 Kernel 영역에 프로세스과 함께 저장한다.

>[PCB에 저장되는 정보]   
>PID(Process ID) : 프로세스 고유의 번호
>Registers: 레지스터의 중간값   
>Process state: 대기,준비, 실행 등의 프로세스 상태
>CPU scheduling information : 언제, 어떤 순서로 cpu 할당 받을지의 정보   
>Memory: 프로세스의 메모리 적재 주소, 베이스 레지스터, 한계 레지스터, 페이지 테이블 
>List of Open files : 입출력장치 정보

### 이 PCB로 어떻게 관리하나?
CPU는 하나의 프로세스를 처음부터 끝까지 실행하고 다음 프로세스로 넘어가는 게 아니라 여러개의 프로세스를 일부씩 실행한다. 

이 때 한 프로세스의 작업을 멈추고 그 작업까지의 중간 값(프로그램 카운터, 각종 레지스터 값 등)을 필수적으로 저장해야 하는데 이것을 PCB에 저장하는 것이다. 

이 중간 정보는 `문맥Context`으로 추상화하여 표현되고 기존 프로세스의 문맥을 백업하고 다음 프로세스의 문맥을 읽어서 실행하는 것을 `문맥 교환 Context Switching` 이라고 한다. 
(이 문맥 교환의 속도가 빨라지면 프로세스들은 동시에 실행되는 것처럼 보인다)

>[동시에 실행되는 것 '처럼' 보인다]   
>프로세스간의 문맥교환으로 동시에 실행되는 것처럼 보인다는 것은 동시성(Concurrency)를 의미한다.   
>정말 동시에 실행되는 것은  CPU의 다수 코어에 의한 병렬성(Parallelism)을 의미한다.

## 프로세스의 구성

`정적 할당 영역`   
코드 영역Code Segment : 기계어로 이루어진 명령어. Read-Only

데이터 영역 Data Segment : 프로그램 실행 동안 유지되는 데이터 
ex) 전역변수, 상수

`동적 할당 영역`   
힙 영역 Heap Segment : 프로그래머가 직접 할당할 수 있는 저장 공간 
ex)생성자, 인스턴스 (C에서 malloc()과 free()로 관리하는 영역) 

스택 영역 Stack Segment : 함수의 호출에 의해 할당되고 함수 종료시 소멸하는 데이터 
ex)매개변수, 지역변수 

*즉, PCB가 있는 커널영역과 사용자 영역을 구성하는 위 네가지 영역으로 프로세스가 구성된다*

## 프로세스의 상태

프로세스는 번갈아 실행되는 과정에서 여러 상태를 거치는데, 이 상태를 cpu는 알아야 한다. 
입출력장치를 사용하는 프로세스의 경우 입력 완료 인터럽트를 기다려야 실행할 수 있는 경우가 있고, 실행이 끝난 프로세스는 메모리를 반환해야 하기 때문이다. 
그래서 운영체제는 PCB에 프로세스의 상태를 저장하고 이를 읽어낸다. 

- 생성 상태(new)
- 준비 상태(ready)
- 대기상태(blocked) 
- 실행상태(running)
- 종료상태(terminated)

`준비상태 vs 대기상태`   
준비상태는 cpu에서 메모리를 할당받으면 실행할 수 있는 상태를 의미한다. 
준비상태에서 실행상태가 되는 것을 **dispatch**라고 한다 

대기상태는 입출력 장치의 완료 신호(인터럽트)를 기다리는 등 특정 이벤트의 발생을 기다리는 상태를 의미한다. 대기상태에서 이벤트가 완료되면 **준비상태**가 된다. 

## 스레드

### 프로세스와 스레드  
스레드는 `프로세스를 구성하는 실행 단위`를 의미한다 
스레드는 프로세스의 자원을 공유하며 여러개가 존재 할 수 있다. 
스레드들은 위에서 살펴 본 프로세스의 스택 영역에 존재하며 프로세스의 코드,데이터, 힙영역을 다른 스레드들과 공유할 수 있다. 

